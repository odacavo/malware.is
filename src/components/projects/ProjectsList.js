import React from 'react'
import { graphql, useStaticQuery } from 'gatsby'

//CSS
import * as styles from '../../css/components/projects/projectslist.module.css'

export default function ProjectsList() {
    const data = useStaticQuery(graphql`
    query projectsList {
      allMarkdownRemark(
        filter: {fileAbsolutePath: {regex: "/(projects)/"}}
        limit: 5
        sort: {order: DESC, fields: frontmatter___date}
      ) {
        nodes {
          frontmatter {
            title
            slug
            description
            date(formatString: "MMM DD, YYYY")
            emoji
            links {
              display
              url
            }
          }
          id
        }
      }
    }
    
      `)

    const projects = data.allMarkdownRemark.nodes

    return (
        <div>
            <ul className={styles.projectsList}>
                {projects.map(post => (
                  <li key={post.id}>
                      <h3>{post.frontmatter.emoji} {post.frontmatter.title}</h3>
                      <p dangerouslySetInnerHTML={{ __html: post.frontmatter.description }}/>
      
                      <p>Links: {post.frontmatter.links.map((plink, i) => [
                      <span key={i}><a href={plink.url} target="_blank" rel="noreferrer">
                        {plink.display}
                        </a>
                        {i < post.frontmatter.links.length - 1 ? ' | ' : ''}
                      </span>
                    ])}</p>
                  
                  </li>
                ))}
            </ul>

        </div>
    )
}
