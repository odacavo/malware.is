---
title: "I Built a Tool to Defend Against BITB Phishing Attacks"
date: "2022-03-24"
slug: "i-built-a-tool-to-defend-against-bitb-phishing-attacks"

description: "Enhanced iFrame Protection (EIP) is a lightweight extension I created to automatically detect and provide verbose warnings for embedded iframe elements in order to protect against Browser-In-The-Browser (BITB) attacks."
tags: ["phishing", "development", "web"]
---

## What is a Browser-In-The-Browser Attack?
Last week, the well-known security researcher [@mrd0x](https://twitter.com/mrd0x) released a clever phishing technique (Browser-In-The-Browser, BITB) that simulates a browser window within the browser to spoof a legitimate domain. This technique uses a combination of HTML/CSS and JavaScript to replicate an OpenID pop-up login window to host an iframe pointing to a malicious phishing page, essentially indistinguishable to the end-user. An example of this technique in use next to a legitimate popup is seen below (taken from @mrd0x's blog post):

![BITB attack, comparison example](/images/writing/i-built-a-tool-to-defend-against-bitb-phishing-attacks/real-fake.png)
{class-postImageCaption}**Left:** A phishing login page using the BITB attack. **Right:** A legitimate Facebook pop-up login page - *Image obtained from [@mrd0x](https://mrd0x.com/browser-in-the-browser-phishing-attack/)*{/}

For more information on this attack, please see [@mrd0x's blog post](https://mrd0x.com/browser-in-the-browser-phishing-attack/), or view [his Github Repo](https://github.com/mrd0x/BITB).

## Playing Defense
Since this attack for the most part relies on `iframe` elements pointing to malicious pages, I thought it may be a good idea to have a browser extension that can identify iframes on a webpage and warn the user of their true location. For example, you can use this BITB technique on the front-end to hide an iframe and make it appear to come from `www.facebook.com`, but in the website's source code, that iframe would be pointing to `www.malicious-phishing.com`. The goal is to override the intention of the attacker and provide the user with a verbose warning that the element they're interacting with actually belongs to `www.malicious-phishing.com`, for example.

I have been working with browser extension development lately, notably with [Privacy Screen](https://malware.is/writing/privacyscreen-a-digital-privacy-filter), so I was definitely prepared to take on this project.

## Enhanced iFrame Protection
[Enhanced iFrame Protection (EIP)](https://github.com/odacavo/enhanced-iframe-protection) is a lightweight extension I created to automatically detect and provide verbose warnings for embedded iframe elements in order to protect against Browser-In-The-Browser (BITB) attacks.

![EIP warning message example](/images/writing/i-built-a-tool-to-defend-against-bitb-phishing-attacks/eip-example.png)
{class-postImageCaption}Enhanced iFrame Protection warning message in action{/}

In the above screenshot, a phishing website has embedded an `iframe` element within a div that has been styled to look like an actual browser window (with a fake URL bar claiming to be from `accounts.google.com`). 

This extension has detected the `iframe` and presented a security warning, highlighting the actual phishing domain as (`bigphish.ca`).

## Limitations
I mentioned that for the most part, this attack and its templates rely on using iframe elements to manipulate the user's interactions. However, this attack can still be performed by hardcoding a malicious login page within a `<div>`, for example. This is a known limitation and one that by the logic of this extension, cannot be overcome. Since the templates that attackers are most likely to use include iframes, this extension will defend against the most common scenarios in the wild.

# Installation
I have published the extension for installation on a number of browser add-on/extension listings:
- [Mozilla Firefox](https://addons.mozilla.org/en-CA/firefox/addon/enhanced-iframe-protection/)
- [Google Chrome](https://chrome.google.com/webstore/detail/enhanced-iframe-protectio/efankjkjendcjahollcfkfhdaffmpkck)
- [Microsoft Edge](https://microsoftedge.microsoft.com/addons/detail/enhanced-iframe-protectio/nhagefgjgbhenhbjijbbnbfphjjdbhof)

The GitHub repo can be found here, should you wish to view the source or contribute in any way:
- [https://github.com/odacavo/enhanced-iframe-protection](https://github.com/odacavo/enhanced-iframe-protection)

## Contributing
Pull requests are welcome if you see a way to make this extension more efficient and lightweight. For major changes or feature additions, please open an issue first to discuss what you would like to change.

## License
[MIT](https://choosealicense.com/licenses/mit/)



## References:
- [https://mrd0x.com/browser-in-the-browser-phishing-attack/](https://mrd0x.com/browser-in-the-browser-phishing-attack/)
- [https://github.com/mrd0x/BITB](https://github.com/mrd0x/BITB)
- [https://github.com/odacavo/enhanced-iframe-protection](https://github.com/odacavo/enhanced-iframe-protection)